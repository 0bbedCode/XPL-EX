{"builtin":false,"collection":"Intika","group":"DNS Firewall","name":"InetAddress.getAllByName","author":"Intika","version":4,"description":"This hook prevents apps from getting a successful DNS resolution.","className":"java.net.InetAddress","methodName":"getAllByName","parameterTypes":["java.lang.String"],"returnType":"[Ljava.net.InetAddress;","minSdk":1,"maxSdk":999,"minApk":0,"maxApk":2147483647,"enabled":true,"optional":false,"usage":true,"notify":false,"luaScript":"-- Intika.InetAdress.getXByName is a Lua hook designed to work with XPrivacyLua.\n-- Copyright (C) 2018 Philippe Troin (Fif_ on XDA)\n-- Copyright (C) 2021 Intika (Intika on XDA)\n\n-- Intika.InetAdress.getXByName is free software: you can redistribute it and\/or modify\n-- it under the terms of the GNU General Public License as published by\n-- the Free Software Foundation, either version 3 of the License, or\n-- (at your option) any later version.\n\n-- Intika.InetAdress.getXByName is distributed in the hope that it will be useful,\n-- but WITHOUT ANY WARRANTY; without even the implied warranty of\n-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-- GNU General Public License for more details.\n\n-- You should have received a copy of the GNU General Public License\n-- along with XPrivacyLua.  If not, see <http:\/\/www.gnu.org\/licenses\/>.\n\nfunction before(hook, param)\n\n    local host = param:getArgument(0)\n\n    if host == nil then\n        host = '(null)'\n    end\n\n    log('Deny ' .. host)\n    local clsHostNotFound = luajava.bindClass('java.net.UnknownHostException')\n    local fake = luajava.new(clsHostNotFound, 'Privacy')\n    param:setResult(fake)\n    return true, host\n\nend\n"}