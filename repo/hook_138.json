{"builtin":false,"collection":"Intika-Google-FCM","group":"Use firebase","name":"Intent.createFromParcel\/com.google.android.c2dm","author":"Intika","version":2,"description":"Name:\nUse firebase (Block Google Firebase Cloud Messaging)\n\nHook Part: \n01\/15\n\nDescription: \nGoogle play services provide a cloud messaging system (fcm\/gcm) allowing apps requesting it to have network server\/client communications, this hook prevent that.\nApplications using fcm\/gcm communicate directly with the google play service app through IPC and thus bypass most policy for network firewalling (iptables, aosp network permissions etc.) this is a big concern for advanced users who are using tools like afwall\/netguard\/iptables\/aosp-network-permission as fcm bypass all this when google play services is installed and allowed for networking (which is most of the time the case).\nThis is the main hook, others hooks are optional and meant to hide google play services app and google services framework app, basically the first hook alone do the job, but for a wider coverage we can use all the hooks (15\/15).\nThis hook deny access to fcm\/gcm intent without needing to hook the upstream method bindService (android.os.IBinder) and thus IPC requests timeouts because they don't target google play services anymore (nil target intent).\nThis was a huge concern for me for a long time as google services are essential on most today's android phones but never had the time to tackle it until today.\nThis bundle of hooks can be used along with the similar block applications list access hooks by M66B and Fif_.\nUsing this in combination with aosp-network-permission\/afwall\/netguard should permit a correct network firewalling on android :) ... still not perfect but acceptable.\nThis hooks are provided as is and were not extensively tested, some apps may not like them.\n@intikaa (telegram)\n\nTesting:\nYou can test this hooks with the following apps\nhttps:\/\/play.google.com\/store\/apps\/details?id=fr.smarquis.fcm\nhttps:\/\/play.google.com\/store\/apps\/details?id=com.hippiedevel.firebasenotificationsender\n\nNote: \nPlease make sure all hooks in the set are at the same version!\n\nNote:\nMentioning \"acceptable\" as a firewall bundle solution on android because of the other possible network leaks like requesting an url through the browser or using advanced libraries or exploiting an other IPC etc.\n\nBased on:\nHooks from: M66B and Fif_\n\nLinks:\nhttps:\/\/github.com\/intika\n\nDocumentation:\nhttps:\/\/firebase.google.com\/docs\/reference\/admin\/java\/reference\/com\/google\/firebase\/messaging\/FirebaseMessaging\nhttps:\/\/github.com\/SimonMarquis\/FCM-toolbox\nhttps:\/\/simonmarquis.github.io\/FCM-toolbox\/\nhttps:\/\/proandroiddev.com\/ipc-techniques-for-android-45d815ac59be\nhttps:\/\/stackoverflow.com\/questions\/5740324\/what-are-the-ipc-mechanisms-available-in-the-android-os","className":"android.content.Intent","methodName":"CREATOR:createFromParcel","parameterTypes":["android.os.Parcel"],"returnType":"android.content.Intent","minSdk":1,"maxSdk":999,"minApk":0,"maxApk":2147483647,"enabled":true,"optional":false,"usage":true,"notify":false,"luaScript":"-- Copyright 2022-2022 Intika\n-- Copyright 2017-2019 Marcel Bokhorst (M66B)\n\n-- This is free software: you can redistribute it and\/or modify\n-- it under the terms of the GNU General Public License as published by\n-- the Free Software Foundation, either version 3 of the License, or\n-- (at your option) any later version.\n\n-- This is distributed in the hope that it will be useful,\n-- but WITHOUT ANY WARRANTY; without even the implied warranty of\n-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-- GNU General Public License for more details.\n\n-- You should have received a copy of the GNU General Public License\n-- along with XPrivacyLua.  If not, see <http:\/\/www.gnu.org\/licenses\/>.\n\nfunction after(hook, param)\n\n    local intent = param:getResult()\n    if intent == nil then\n        return false\n    end\n\n    local action = intent:getAction()\n    if action == nil then\n        return false\n    end\n\n    -- local h = hook:getName()\n    -- local match = string.gmatch(h, '[^\/]+')\n    -- local func = match()\n    -- local name = match()\n    -- if name == 'package' then end\n\n    if action == 'com.google.android.c2dm.intent.REGISTER' or action == 'com.google.android.c2dm.intent.C2D_MESSAGE' or action == 'com.google.android.c2dm.intent.REGISTRATION' or action == 'com.google.android.c2dm.intent.RECEIVE' or action == 'com.google.android.c2dm.intent.START_SERVICE' or action == 'com.google.firebase.MESSAGING_EVENT' or action == 'com.google.firebase.INSTANCE_ID_EVENT' or action == 'com.google.android.gms.gcm.REGISTER' or action == 'com.google.android.gms.gcm.REGISTERED' or action == 'com.google.android.gcm.intent.SEND' or action == 'com.google.android.gms.auth.authzen.REGISTER_NOW' or action == 'com.google.android.gms.auth.authzen.TEST_UI' or action == 'com.google.android.gms.auth.authzen.CHECK_REGISTRATION' then\n\n        param:setResult(nil)\n        return true\n\n    else\n        return false\n    end\nend\n"}