{"builtin":false,"collection":"Fif","group":"Read.Network","name":"NetworkInfo.toString","author":"Fif_","version":3,"description":"Please refer to the WifiInfo.toString hook documentation.\n\nChangelog (for NetworkInfo.toString):\n\nv3 - 2018-10-08\nWhen anonymizing fails, set the returned value to Private.\n\nv2 - 2018-10-08\nUpdate doc string.\nActually set the fake return value, doh.\n\nv1 - 2018-09-05\nFirst public release.\n","className":"android.net.NetworkInfo","methodName":"toString","parameterTypes":[],"returnType":"java.lang.String","minSdk":1,"maxSdk":999,"minApk":0,"maxApk":2147483647,"enabled":true,"optional":false,"usage":true,"notify":false,"luaScript":"-- NetworkInfo.toString is a Lua hook definition designed to work                     \n-- with XPrivacyLua.\n\n-- NetworkInfo.toString is free software: you can redistribute it and\/or modify\n-- it under the terms of the GNU General Public License as published by\n-- the Free Software Foundation, either version 3 of the License, or\n-- (at your option) any later version.\n\n-- NetworkInfo.toString is distributed in the hope that it will be useful,\n-- but WITHOUT ANY WARRANTY; without even the implied warranty of\n-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-- GNU General Public License for more details.\n\nfunction after(hook, param)\n    local result = param:getResult()\n    if result == nil then\n        return false\n    end\n\n    if result:find(\", extra: [(]none[)], [a-zA-Z_]+: \") ~= nil \n       or result:find(\", extra: <unknown ssid>, [a-zA-Z_]+: \") ~= nil then\n        return false\n    end\n\n    local fake, changed, pattern, replacement\n    changed = 0\n    for pattern, replacement in pairs({[ \"(, extra: \\\").*(\\\", [a-zA-Z_]+: )\"      ] = \"%1Private%2\",\n                                       [ \"(, extra: )[^\\\"][^,]*(, [a-zA-Z_]+: )\"  ] = \"%1private%2\"}) do\n        fake, changed = result:gsub(pattern, replacement)\n        if changed == 1 then\n            break\n        end\n    end\n\n    if changed == 0 then\n        fake = 'Private'\n    end\n\n    param:setResult(fake)\n\n    return true, result, fake\nend\n"}