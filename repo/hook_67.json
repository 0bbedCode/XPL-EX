{"builtin":false,"collection":"Privacy","group":"Use.Tracking","name":"TelephonyManager\/getNetworkOperator","author":"M66B,hKFirEs","version":4,"description":"Replace the built-in hook to fake mcc and mnc with getNetworkOperator method,for gsm users only.Setting must match exactly like \"MCC,MNC\",for example,\"460,00\".If you want to get a fake location by Celluar,you should also download and enable my modified getCellLocation hook definition.","className":"android.telephony.TelephonyManager","methodName":"getNetworkOperator","parameterTypes":[],"returnType":"java.lang.String","minSdk":1,"maxSdk":999,"minApk":0,"maxApk":2147483647,"enabled":true,"optional":false,"usage":true,"notify":false,"luaScript":"-- This file is part of XPrivacyLua.\n\n-- XPrivacyLua is free software: you can redistribute it and\/or modify\n-- it under the terms of the GNU General Public License as published by\n-- the Free Software Foundation, either version 3 of the License, or\n-- (at your option) any later version.\n\n-- XPrivacyLua is distributed in the hope that it will be useful,\n-- but WITHOUT ANY WARRANTY; without even the implied warranty of\n-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-- GNU General Public License for more details.\n\n-- You should have received a copy of the GNU General Public License\n-- along with XPrivacyLua.  If not, see <http:\/\/www.gnu.org\/licenses\/>.\n\n-- Copyright 2017-2018 Marcel Bokhorst (M66B)\n\nfunction after(hook, param)\n    local result = param:getResult()\n    if result == nil then\n        return false\n    end\n\n    local fake = '00101'\n\n    local setting = param:getSetting(\"MCC,MNC\")\n    if setting == nil then\n    \tparam:setResult(fake)\n    \treturn true, result, fake\n    end\n\t\n    local index = string.find(setting,\",\",1,true)\n    if index == nil then\n    \tparam:setResult(fake)\n    \treturn true, result, fake\n    end\n\t\n    local fakemcc = string.sub(setting,1,index-1)\n    local fakemnc = string.sub(setting,index+1,-1)\n\n    if tonumber(fakemcc) == nil or tonumber(fakemnc) == nil then\n    \tparam:setResult(fake)\n    \treturn true, result, fake\n    end\n\n    fake = fakemcc..fakemnc\n    param:setResult(fake)\n    return true, result, fake\nend\n","settings":["MCC,MNC"]}