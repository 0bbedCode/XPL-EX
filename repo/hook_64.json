{"builtin":false,"collection":"Fif","group":"Read.Network","name":"WifiInfo.getIpAddress","author":"Fif_","version":1,"description":"Better version (logs the IP address in human-readable form) of the same hook by A200K.\nInternal Wifi IP address restriction.\n","className":"android.net.wifi.WifiInfo","methodName":"getIpAddress","parameterTypes":[],"returnType":"int","minSdk":1,"maxSdk":999,"minApk":0,"maxApk":2147483647,"enabled":true,"optional":false,"usage":true,"notify":false,"luaScript":"-- Fif.WifiInfo.getIpAddress is a Lua hooks designed to work with XPrivacyLua.\n-- Copyright (C) 2018 Philippe Troin (Fif_ on XDA)\n\n-- Fif.WifiInfo.getIpAddress is free software: you can redistribute it and\/or modify\n-- it under the terms of the GNU General Public License as published by\n-- the Free Software Foundation, either version 3 of the License, or\n-- (at your option) any later version.\n\n-- Fif.WifiInfo.getIpAddress is distributed in the hope that it will be useful,\n-- but WITHOUT ANY WARRANTY; without even the implied warranty of\n-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-- GNU General Public License for more details.\n\n-- You should have received a copy of the GNU General Public License\n-- along with XPrivacyLua.  If not, see <http:\/\/www.gnu.org\/licenses\/>.\n\nfunction after(hook, param)\n    local result = param:getResult()\n    if result == nil then\n        return false\n    end\n\n    local resultAcc = result\n    local resb1 = math.floor(resultAcc \/ 256 \/ 256 \/ 256)\n    resultAcc = resultAcc - resb1 * 256 * 256 * 256\n    local resb2 = math.floor(resultAcc \/ 256 \/ 256)\n    resultAcc = resultAcc - resb2 * 256 * 256\n    local resb3 = math.floor(resultAcc \/ 256)\n    local resb4 = math.floor(resultAcc - resb3 * 256)\n\n    -- Assuming luaJ's ints are little-endian, which does not make sense\n    -- but seems to be the case\n    local fake, fakeStr, resultStr\n    fake = 0x0100007F\n    fakeStr = '127.0.0.1'\n    resultStr = string.format('%d.%d.%d.%d', resb4, resb3, resb2, resb1)\n    \n    param:setResult(fake)\n    return true, resultStr, fakeStr\nend\n"}